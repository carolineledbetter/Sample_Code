---
output: pdf_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=3, fig.height=3, 
                      echo=FALSE, warning=FALSE, message=FALSE)
```

```{r setup}
#load dataset
load(file = '/Users/Caroline/Repositories/Data/Project0Data/Project0cleandatanomissing.rda')

#attach data set so just variable names can be used 
attach(Project0_no_missing)

library(car)
#fxn for histogram of studentized residuals
hist_resid <- function(lm){
  require(MASS)
  sresid <- studres(lm) 
  hist(sresid, freq=FALSE, 
       main="Distribution of
       Studentized Residuals")
  xfit<-seq(min(sresid),max(sresid),length=40) 
  yfit<-dnorm(xfit) 
  lines(xfit, yfit)
}
```
__Diagnostic Plots for Y= attachment at 1 year, X = Treatment group__
\newline
```{r linear attach plots}
lm1yrattach <-lm(attach1year~trtgroupFactored)
qqPlot(lm1yrattach, main = "QQ Plot")
spreadLevelPlot(lm1yrattach)
hist_resid(lm1yrattach)
```
\newpage
__Diagnostic Plots for Y=log(attachment at 1 year), X = Treatment group__
\newline
```{r log attach plots}
logattach <- log(attach1year)
lmlogattach <- lm(logattach~trtgroupFactored)
qqPlot(lmlogattach)
spreadLevelPlot(lmlogattach)
hist_resid(lmlogattach)
```
\newpage
__Diagnostic Plots for log transformed outcome and model includes baseline measurements with treatment group.__
\newline
```{r log attach plots adjusted for baseline}
lmlogattach_base <- lm(logattach~trtgroupFactored+attachbase)
qqPlot(lmlogattach_base)
spreadLevelPlot(lmlogattach_base)
hist_resid(lmlogattach_base)
```
\newpage
__Diagnostic Plots for outcome (not transformed) and model includes baseline measurements with treatment group.__
\newline
```{r attach plots adjusted for baseline}
lm1yrattach_base <- lm(attach1year~trtgroupFactored+attachbase)
qqPlot(lm1yrattach_base)
spreadLevelPlot(lm1yrattach_base)
hist_resid(lm1yrattach_base)
```
\newpage
__Diag plots of just attachment at 1 yr vs baseline__
\newline
```{r attach plots just baseline}
lm1yrattach_baseonly <- lm(attach1year ~ attachbase)
qqPlot(lm1yrattach_baseonly)
spreadLevelPlot(lm1yrattach_baseonly)
hist_resid(lm1yrattach_baseonly)
```